/*! WIMP Member Directory - v0.1.0
 * http://beawimp.org/member-directory
 * Copyright (c) 2015;
 * Licensed GPLv2+
 */
var WMD;(function(t,e){"use strict";var a,i=t.document,n=t.wp;WMD={init:function(){WMD.uploadLogo(),WMD.uploadPortfolio(),WMD.editListing(),WMD.saveListing()},uploadLogo:function(){e(i.getElementById("upload-image")).click(function(t){t.preventDefault(),WMD.media(e(t.target))})},uploadPortfolio:function(){e(i.getElementsByClassName("upload-portfolio")).click(function(t){t.preventDefault(),WMD.media(e(t.target))})},editListing:function(){e(i.getElementsByClassName("add-new-tax")).click(function(t){t.preventDefault();var n=e(this),o=e(i.getElementById("wmd-listing-nonce")).val();a=n.prev();var l={term:a.val(),tax:a.attr("data-type")};WMD.ajax("wmd_save_listing_tax",o,l)})},saveListing:function(){e(i.getElementById("wmd-listings")).submit(function(t){t.preventDefault();var a,n=e(this),o=e(i.getElementById("wmd-listing-nonce")).val(),l=this.elements,s={industry:{},tech:{},type:{},portfolio:{}},r=1;s.content=n.find("#content").val(),s.id=n.find("#id").val();for(var d=0;l.length>d;d++){var c=l[d];if(c.hasAttribute("data-save"))if(WMD.isInt(c.id)){var u=c.name.match(/wmd\[(.*)\]\[[0-9]{1,10}\]/);s[u[1]][r]=c.value,a&&u[1]!==a?r=1:r++,a=u[1]}else{var f=c.name.match(/wmd\[(.*)\]\[[0-9]{1,10}\]/);if(null!==f){var m=c.getAttribute("data-id");s.portfolio[m]=c.value}else s[c.id]=c.value}}WMD.ajax("wmd_save_listing_post",o,s)})},ajax:function(t,e,a){n.ajax.send(t,{success:WMD.ajaxSuccess,error:WMD.ajaxError,data:{nonce:e,data:a}})},ajaxSuccess:function(t){var e='<label for="'+t.term_id+'">'+'<input type="checkbox" '+'name="wmd['+t.taxonomy+"]["+t.term_id+']" '+'value="'+t.name+'" '+'id="'+t.term_id+'" '+'checked="checked" /> '+t.name+"</label>";a.val("").prev().after(e)},ajaxError:function(t){WMD.listingTaxNotification("error",t)},listingTaxNotification:function(t,n){var o='<div class="wmd-notification wmd-'+t+'">'+n+"</div>";e(i.getElementsByClassName("wmd-notification")).fadeOut().remove(),a.next().after(o).next().fadeIn(),"success"===t&&e(i.getElementsByClassName("wmd-success")).fadeOut().remove()},isInt:function(t){return!isNaN(t)&&function(t){return(0|t)===t}(parseFloat(t))},load:function(){e(".flexslider").flexslider({controlNav:!1})}},e(t).load(WMD.load),e(i).ready(WMD.init)})(this,jQuery);